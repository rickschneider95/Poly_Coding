knitr::opts_chunk$set(echo = TRUE)
```{r,message=FALSE,warning =FALSE}
library(readr)
library(tidyverse)
library(tidyverse)
library(ggplot2)
library(readr)
house <- read_csv("data/realestate.csv",header=TRUE)
house <- read_csv("data/realestate.csv")
View(house)
dim(house)
head(house)
#delete column "ID":
house <- house[,-1]
head(house)
#dim of house:
dim(house)
View(house)
house <- read_csv("data/realestate.csv")
head(house)
#delete column "ID":
house <- house[,-1]
#dim of house:
dim(house)
#Exploratory data analysis:
```{r,message=FALSE}
#read data in and have a look at it:
house <- read_csv("data/realestate.csv")
head(house)
#delete column "ID":
house <- house[,-1]
#dim of house:
dim(house)
names(house)
#we only work with "house":
attach(house)
distinct(Pool)
house %>% select(Pool) %>% distinct()
names(house)
#which values does "Quality" take?:
house %>% select(Quality) %>% distinct()
names(house)
#which values does "AdjHighway" take?:
house %>% select(AdjHighway) %>% distinct()
names(house)
#histogram:
qplot(Price)
#histogram:
qplot(Price) +
geom_histogram(col="red")
#histogram:
qplot(Price) +
geom_histogram(col="white")
#histogram:
qplot(Price) +
geom_histogram(col="white",
bins=40)
#histogram:
qplot(Price) +
geom_histogram(col="white",
bins=35)
#histogram:
ggplot(data=house, aes(Price) +
#histogram:
ggplot(data=house, aes(Price) +
#histogram:
ggplot(data=house, aes(Price)) +
geom_histogram(col="white",
bins=35)
#histogram:
ggplot(data=house, aes(Price)) +
#histogram:
ggplot(data=house, aes(Price)) +
geom_histogram(col="white",
bins=35)
#histogram:
ggplot(data=house, aes(Price)) +
geom_histogram(col="white",
bins=35) +
labs(title="Histogram for Price")
#boxplot:
ggplot(data=house, aes(Price)) +
geom_boxplot()
#boxplot:
ggplot(data=house, aes(x="", y=Price)) +
geom_boxplot()
#histogram:
ggplot(data=house, aes(Price)) +
geom_histogram(col="white",
bins=35) +
labs(title="Histogram for Price")
#summary statistics:
summary(Price)
qqplot(Price)
ggplot(Price)
qqnorm(Price)
#boxplot:
ggplot(data=house, aes(x="", y=Price)) +
geom_boxplot()
#Check for impossible values:
sum(is.na(Price))
sum(Price[Price < 0])
#histogram:
ggplot(data=house, aes(Price)) +
geom_histogram(col="white",
bins=35) +
labs(title="Histogram for Price")
plot(House)
plot(house)
cor(house)
#histogram:
ggplot(data=house, aes(Sqft)) +
geom_histogram(col="white",
bins=35) +
labs(title="Histogram for Price")
#summary:
summary(Sqft)
ggplot(data=house, aes(Bedroom)) +
geom_bar(aes(fill=Bedroom))
table(Bedroom)
table(Bathroom)
ggplot(data=house, aes(Bathroom)) +
geom_bar()
table(Airconditioning)
ac_table[1]
ac_table<-table(Airconditioning)
ac_table[1]
100*[2]/(ac_table[1]+ac_table[2])
100*ac_table[2]/(ac_table[1]+ac_table[2])
ac_table
ggplot(data=house, aes(Garage)) +
geom_bar()
table(Garage)
ggplot(data=house, aes(Pool)) +
geom_bar()
table(Pool)
pool_table <-table(Pool)
pool_table
100*pool_table[2]/(pool_table[1]+pool_table[2])
ggplot(data=house, aes(YearBuild)) +
geom_bar()
summary(YearBuild)
ggplot(data=house, aes(YearBuild)) +
geom_bar()
table(Quality)
house %>%
group_by(Quality) %>%
summarise(mean(Price))
#histogram:
ggplot(data=house, aes(Lot)) +
geom_histogram(col="white",
bins=35) +
labs(title="Histogram for Lot")
#is it normal?
qqnorm(Price)
#is it normal?
qqnorm(Lot)
#boxplot:
ggplot(data=house, aes(x="", y=Lot)) +
geom_boxplot()+
labs(title="Boxplot for Lot")
#histogram:
ggplot(data=house, aes(Lot)) +
geom_histogram(col="white",
bins=35) +
labs(title="Histogram for Lot")
#summary statistics:
summary(Lot)
#null values?
sum(is.na(Lot))
#null values?
sum(is.na(Quality))
#null values?
sum(is.na(YearBuild))
#null values?
sum(is.na(Pool))
#null values?
sum(is.na(Garage))
#null values?
sum(is.na(Bathroom))
#null values?
sum(is.na(Bedroom))
#null values?
sum(is.na(Sqft))
#are they correlated?
cor(Price,Lot)
#scatter plot with Price
ggplot(data=house,aes(x=Lot,y=Price))+
geom_point()
#scatter plot with Price
ggplot(data=house,aes(x=Lot,y=Price))+
geom_point() +
labs(title="Scatter plot of Lot(x) against Price(y)")
#are they correlated?
cor(Price,Lot)
#boxplot:
ggplot(data=house, aes(x="", y=Lot)) +
geom_boxplot()+
labs(title="Boxplot for Lot")
#scatter plot with Price
ggplot(data=house,aes(x=Lot,y=Price))+
geom_point() +
labs(title="Scatter plot of Lot(x) against Price(y)")
#table for the quality:
table(AdjHighway)
#null values?
sum(is.na(AdjHighway))
house %>%
group_by(AdjHighway) %>%
summarise(mean(Price))
#table for the quality:
table(AdjHighway)
house %>%
group_by(AdjHighway) %>%
summarise(mean(Price))
#summary:
summary(Sqft)
#scatter plot:
ggplot(data = house, aes(x=Sqft,y=Price))+
geom_point()
#scatter plot:
ggplot(data = house, aes(x=Sqft,y=Price))+
geom_point()+
labs(title="Scatter plot of the price as a function of the size (Sqft)")
#correlation:
cor(Price,Sqft)
table(Bathroom)
#mean for the different values of the categorical variable:
house %>%
group_by(Bedroom) %>%
summarise(mean(Price))
#mean for the different values of the categorical variable:
mean_cat <- house %>%
group_by(Bedroom) %>%
summarise(mean(Price))
mean_cat
#mean for the different values of the categorical variable:
mean_cat <- house %>%
group_by(Bedroom) %>%
summarise(m=mean(Price))
mean_cat
ggplot(data=mean_cat, aes(m)) +
geom_bar()
mean_cat
ggplot(data=mean_cat, aes(x=Bedroom,y=m)) +
geom_point()
cor(mean_cat$Bedroom,mean_cat$m)
#plot the mean values for the diffrent bedrooms:
ggplot(data=mean_cat, aes(x=Bedroom,y=m)) +
geom_point()
ggplot(data=house, aes(Bedroom)) +
geom_bar()
#mean for the different values of the categorical variable:
mean_cat <- house %>%
group_by(Bathroom) %>%
summarise(m=mean(Price))
#plot the mean values for the diffrent bedrooms:
ggplot(data=mean_cat, aes(x=Bathroom,y=m)) +
geom_point()
mean_cat
#null values?
sum(is.na(Airconditioning))
#mean for the two values:
house %>%
group_by(Airconditioning) %>%
summarise(m=mean(Price))
#null values?
sum(is.na(Garage))
table(Garage)
#mean for the different values of the categorical variable:
mean_cat <- house %>%
group_by(Garage) %>%
summarise(m=mean(Price))
mean_cat
#plot the mean values for the diffrent bedrooms:
ggplot(data=mean_cat, aes(x=Garage,y=m)) +
geom_point()
#Is a house with a pool worth more?
house %>%
group_by(Pool) %>%
summarise(m=mean(Price))
#barplot
ggplot(data=house, aes(YearBuild)) +
geom_bar()
#scatterplot between the year and the price:
ggplot(data=house, aes(x=YearBuild,y=Price))+
geom_point()
#plot the mean values for the diffrent bedrooms:
ggplot(data=mean_cat, aes(x=Bedroom,y=m)) +
geom_point()+
labs(title="Scatter plot of the price as a function of the size (Sqft)")
#mean for the different values of the categorical variable:
mean_cat <- house %>%
group_by(Bedroom) %>%
summarise(m=mean(Price))
#plot the mean values for the diffrent bedrooms:
ggplot(data=mean_cat, aes(x=Bedroom,y=m)) +
geom_point()+
labs(title="Plot of the mean values of the price against the number of bathrooms")
ggplot(data=house, aes(Bathroom)) +
geom_bar()+
labs(title="Barplot of the variable Bathroom")
#barplot
ggplot(data=house, aes(YearBuild)) +
geom_bar()+
labs(title="Barplot of the variable YearBuild")
#scatterplot between the year and the price:
ggplot(data=house, aes(x=YearBuild,y=Price))+
geom_point()+
labs(title="Scatter plot of the price against the year in which the house was built")
#table for the quality:
table(Quality)
house %>%
group_by(Quality) %>%
summarise(mean(Price))
simple_reg <- lm(Price ~ Sqft)
summary(simple_reg)
simple_reg <- lm(Price ~ Sqft+YearBuild)
summary(simple_reg)
ggplot(home, aes(x=Sqft, y=Price)) +
geom_point() +    # Use hollow circles
geom_smooth(method=lm)   # Add linear regression line
ggplot(house, aes(x=Sqft, y=Price)) +
geom_point() +    # Use hollow circles
geom_smooth(method=lm)   # Add linear regression line
ggplot(house, aes(x=Sqft, y=Price)) +
geom_point() +
geom_smooth(method=lm)+   # Add linear regression line
labs(title="Scatter plot of the price vs the size of the house (sqft)")
summary(simple_reg)
simple_reg <- lm(Price ~ Sqft)
summary(simple_reg)
